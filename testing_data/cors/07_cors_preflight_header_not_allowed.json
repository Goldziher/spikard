{
	"name": "07_cors_preflight_header_not_allowed",
	"description": "CORS preflight request with non-allowed header should be rejected",
	"category": "cors",
	"source": {
		"framework": "spikard",
		"inspired_by": "http_specs",
		"test_case": "CORS header validation"
	},
	"handler": {
		"route": "/api/data",
		"method": "POST",
		"cors": {
			"allowed_origins": ["https://example.com"],
			"allowed_methods": ["POST"],
			"allowed_headers": ["Content-Type"]
		},
		"parameters": {
			"headers": {
				"Origin": {
					"type": "string",
					"optional": true
				},
				"Access-Control-Request-Method": {
					"type": "string",
					"optional": true
				},
				"Access-Control-Request-Headers": {
					"type": "string",
					"optional": true
				}
			}
		}
	},
	"request": {
		"method": "OPTIONS",
		"path": "/api/data",
		"headers": {
			"Origin": "https://example.com",
			"Access-Control-Request-Method": "POST",
			"Access-Control-Request-Headers": "X-Custom-Header"
		}
	},
	"expected_response": {
		"status_code": 403
	},
	"tags": ["cors", "preflight", "headers", "validation", "error"]
}
