{
	"$schema": "http://json-schema.org/draft-07/schema#",
	"title": "Static File Serving Test Fixture",
	"description": "Schema for static file serving test fixtures covering tower-http ServeDir/ServeFile integration, MIME types, caching, range requests, and SPA fallback",
	"type": "object",
	"required": ["name", "description", "category", "handler", "request", "expected_response"],
	"properties": {
		"name": {
			"type": "string",
			"description": "Human-readable test case name",
			"minLength": 1
		},
		"description": {
			"type": "string",
			"description": "What this test validates",
			"minLength": 1
		},
		"category": {
			"type": "string",
			"enum": ["static_files"],
			"description": "Test category"
		},
		"handler": {
			"type": "object",
			"description": "Handler configuration including static files middleware",
			"required": ["route", "method"],
			"properties": {
				"route": {
					"type": "string",
					"description": "Route pattern (typically /*filepath for static files)",
					"minLength": 1
				},
				"method": {
					"type": "string",
					"enum": ["GET", "HEAD"],
					"description": "HTTP method (static files support GET and HEAD)"
				},
				"middleware": {
					"type": "object",
					"description": "Middleware configuration",
					"properties": {
						"static_files": {
							"oneOf": [
								{
									"type": "object",
									"description": "Static files middleware configuration using tower-http ServeDir",
									"properties": {
										"root_dir": {
											"type": "string",
											"description": "Root directory for static files (relative or absolute path)"
										},
										"index_file": {
											"type": "string",
											"description": "Index file name (default: index.html)",
											"default": "index.html"
										},
										"fallback_file": {
											"type": "string",
											"description": "Fallback file for SPA routing (e.g., index.html)"
										},
										"precompressed": {
											"type": "boolean",
											"description": "Enable serving pre-compressed files (.gz, .br)",
											"default": false
										},
										"cache_control": {
											"type": "string",
											"description": "Cache-Control header value (e.g., 'public, max-age=3600')"
										}
									},
									"required": ["root_dir"]
								},
								{
									"type": "null",
									"description": "Static files middleware disabled"
								}
							]
						}
					}
				}
			},
			"additionalProperties": false
		},
		"request": {
			"type": "object",
			"description": "HTTP request details",
			"required": ["method", "path"],
			"properties": {
				"method": {
					"type": "string",
					"enum": ["GET", "HEAD"],
					"description": "HTTP method"
				},
				"path": {
					"type": "string",
					"description": "Request path",
					"minLength": 1
				},
				"headers": {
					"type": "object",
					"description": "Request headers (e.g., Range, Accept-Encoding, If-None-Match, If-Modified-Since)",
					"additionalProperties": {
						"type": "string"
					}
				}
			},
			"additionalProperties": false
		},
		"expected_response": {
			"type": "object",
			"description": "Expected HTTP response",
			"required": ["status_code"],
			"properties": {
				"status_code": {
					"type": "integer",
					"description": "Expected HTTP status code (200, 206, 304, 403, 404)",
					"enum": [200, 206, 304, 403, 404]
				},
				"headers": {
					"type": "object",
					"description": "Expected response headers (Content-Type, Cache-Control, ETag, Last-Modified, Content-Range, Accept-Ranges)",
					"additionalProperties": {
						"type": "string"
					}
				},
				"body": {
					"description": "Expected response body - for successful responses includes simulated file metadata, for errors includes RFC 7807 problem details",
					"oneOf": [
						{
							"type": "object",
							"description": "Simulated file response metadata",
							"properties": {
								"simulated_file": {
									"type": "string",
									"description": "File name being served"
								},
								"simulated_size_bytes": {
									"type": "integer",
									"description": "File size in bytes"
								},
								"simulated_content_sample": {
									"type": "string",
									"description": "Sample of file content (optional)"
								}
							}
						},
						{
							"type": "object",
							"description": "RFC 7807 problem details for errors",
							"required": ["type", "title", "status"],
							"properties": {
								"type": {
									"type": "string",
									"description": "URI reference identifying the problem type"
								},
								"title": {
									"type": "string",
									"description": "Short human-readable summary"
								},
								"status": {
									"type": "integer",
									"description": "HTTP status code"
								},
								"detail": {
									"type": "string",
									"description": "Human-readable explanation"
								}
							}
						}
					]
				}
			},
			"additionalProperties": false
		},
		"tags": {
			"type": "array",
			"description": "Tags for categorizing and filtering tests",
			"items": {
				"type": "string"
			}
		},
		"notes": {
			"type": "string",
			"description": "Additional notes about tower-http integration, ServeDir/ServeFile usage, or implementation details"
		}
	},
	"additionalProperties": false
}
