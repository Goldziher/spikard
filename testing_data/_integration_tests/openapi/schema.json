{
	"$schema": "http://json-schema.org/draft-07/schema#",
	"title": "OpenAPI Test Fixtures",
	"description": "Test fixtures for OpenAPI 3.1.0 specification generation, Swagger UI, and Redoc serving",
	"type": "object",
	"required": ["name", "description", "handler", "request", "expected_response"],
	"properties": {
		"name": {
			"type": "string",
			"description": "Test case name",
			"examples": ["OpenAPI spec generation - basic", "Swagger UI serving"]
		},
		"description": {
			"type": "string",
			"description": "What this test validates"
		},
		"category": {
			"const": "openapi",
			"description": "All fixtures in this directory must have category='openapi'"
		},
		"handler": {
			"type": "object",
			"description": "Handler definition with OpenAPI middleware config",
			"required": ["route", "method", "middleware"],
			"properties": {
				"route": {
					"type": "string",
					"description": "Route pattern for the test endpoint"
				},
				"method": {
					"type": "string",
					"enum": ["GET", "POST", "PUT", "PATCH", "DELETE"]
				},
				"parameters": {
					"type": "object",
					"description": "Parameter schemas (path, query, header, cookie)"
				},
				"response_schema": {
					"type": "object",
					"description": "JSON Schema for successful response"
				},
				"middleware": {
					"type": "object",
					"description": "Middleware configuration including OpenAPI",
					"required": ["openapi"],
					"properties": {
						"openapi": {
							"type": "object",
							"required": ["enabled"],
							"properties": {
								"enabled": {
									"const": true,
									"description": "Must be true for OpenAPI tests"
								},
								"title": {
									"type": "string",
									"description": "API title"
								},
								"version": {
									"type": "string",
									"description": "API version"
								},
								"description": {
									"type": "string",
									"description": "API description"
								},
								"swagger_ui_path": {
									"type": "string",
									"description": "Path to serve Swagger UI",
									"default": "/docs"
								},
								"redoc_path": {
									"type": "string",
									"description": "Path to serve Redoc",
									"default": "/redoc"
								},
								"openapi_json_path": {
									"type": "string",
									"description": "Path to serve OpenAPI spec JSON",
									"default": "/openapi.json"
								},
								"contact": {
									"type": "object",
									"description": "Contact information",
									"properties": {
										"name": { "type": "string" },
										"email": { "type": "string" },
										"url": { "type": "string" }
									}
								},
								"license": {
									"type": "object",
									"description": "License information",
									"properties": {
										"name": { "type": "string" },
										"url": { "type": "string" }
									}
								},
								"servers": {
									"type": "array",
									"description": "Server URLs for different environments",
									"items": {
										"type": "object",
										"properties": {
											"url": { "type": "string" },
											"description": { "type": "string" }
										}
									}
								}
							}
						},
						"jwt_auth": {
							"type": "object",
							"description": "JWT authentication config (for security scheme tests)"
						},
						"api_key_auth": {
							"type": "object",
							"description": "API key authentication config (for security scheme tests)"
						}
					}
				}
			}
		},
		"request": {
			"type": "object",
			"description": "HTTP request to OpenAPI endpoints",
			"required": ["method", "path"],
			"properties": {
				"method": {
					"const": "GET",
					"description": "OpenAPI endpoints use GET"
				},
				"path": {
					"type": "string",
					"enum": ["/openapi.json", "/docs", "/redoc"],
					"description": "Path to OpenAPI spec, Swagger UI, or Redoc"
				},
				"headers": {
					"type": "object",
					"properties": {
						"accept": {
							"type": "string",
							"enum": ["application/json", "text/html"]
						}
					}
				}
			}
		},
		"expected_response": {
			"type": "object",
			"description": "Expected response from OpenAPI endpoints",
			"required": ["status_code"],
			"properties": {
				"status_code": {
					"const": 200,
					"description": "OpenAPI endpoints should return 200"
				},
				"headers": {
					"type": "object",
					"description": "Expected response headers",
					"properties": {
						"content-type": {
							"type": "string",
							"enum": ["application/json", "text/html"],
							"description": "JSON for /openapi.json, HTML for /docs and /redoc"
						}
					}
				},
				"body_partial": {
					"type": "object",
					"description": "Partial match for OpenAPI spec (for /openapi.json requests)"
				}
			}
		}
	}
}
