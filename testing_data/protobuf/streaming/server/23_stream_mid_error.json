{
	"name": "Server streaming - mid-stream error",
	"description": "Tests server streaming RPC that sends 5 messages successfully, then encounters an error before completing the stream. Validates partial stream delivery and error handling.",
	"category": "server_streaming",
	"protobuf": {
		"package": "example.v1",
		"messages": [
			{
				"name": "DataStreamRequest",
				"fields": [
					{ "name": "stream_id", "type": "string", "number": 1, "label": "required" },
					{ "name": "fail_after", "type": "int32", "number": 2, "label": "required" }
				]
			},
			{
				"name": "DataStreamMessage",
				"fields": [
					{ "name": "sequence", "type": "int32", "number": 1, "label": "required" },
					{ "name": "payload", "type": "string", "number": 2, "label": "required" }
				]
			}
		],
		"services": [
			{
				"name": "StreamService",
				"methods": [
					{
						"name": "StreamData",
						"input_type": "DataStreamRequest",
						"output_type": "DataStreamMessage",
						"client_streaming": false,
						"server_streaming": true
					}
				]
			}
		]
	},
	"handler": {
		"service": "example.v1.StreamService",
		"method": "StreamData"
	},
	"request": {
		"metadata": {
			"content-type": "application/grpc"
		},
		"message": {
			"stream_id": "stream-001",
			"fail_after": 5
		}
	},
	"expected_response": {
		"status_code": "INTERNAL",
		"stream": [
			{ "sequence": 1, "payload": "Message 1" },
			{ "sequence": 2, "payload": "Message 2" },
			{ "sequence": 3, "payload": "Message 3" },
			{ "sequence": 4, "payload": "Message 4" },
			{ "sequence": 5, "payload": "Message 5" }
		],
		"error": {
			"code": 13,
			"message": "Stream processing failed after 5 messages"
		}
	},
	"tags": ["server_streaming", "error_handling", "partial_stream"]
}
